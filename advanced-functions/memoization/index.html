<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Memoization</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			a {
				color: unset;
				text-decoration: unset;
			}

			body {
				font-family: Inter, sans-serif;
				background: #f9f9f9;
				color: #333;
				padding: 2rem;
			}

			#app {
				max-width: 600px;
				margin: 0 auto;
			}

			.results {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.result-item {
				background: #fff;
				padding: 1rem;
				border-radius: 12px;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
				transition: transform 0.2s ease;
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}

			.result-item:hover {
				transform: translateY(-3px);
			}

			.result-heading {
				display: flex;
				align-items: flex-start;
				justify-content: space-between;

				@media (max-width: 500px) {
					flex-direction: column;
					row-gap: 12px;
				}
			}

			.result-category {
				font-size: 13px;
				border: 1px solid #e6e6e6;
				border-radius: 999px;
				padding-inline: 8px;
				padding-block: 6px;
				font-weight: 600;
			}
		</style>
	</head>
	<body>
		<main id="app"></main>

		<script>
			const app = document.getElementById("app");
			resultsContainer = document.createElement("ul");
			resultsContainer.className = "results";

			app.appendChild(resultsContainer);

			const cache = new Map();
			function fetchCache(url) {
				if (cache.has(url)) return cache.get(url);

				const promise = fetch(url).then((res) => {
					if (!res.ok) throw new Error("Issue fetching data");

					return res.json();
				});
				cache.set(url, promise);
				return promise;
			}

			(async function fetchData() {
				try {
					const data = await fetchCache(`http://localhost:4020/items`);
					render(data.results);
				} catch (err) {
					console.error(err);
				}
			})();

			function render(results) {
				resultsContainer.innerHTML = results
					.map((item) => {
						const { id, title, category, description } = item;
						return /*html*/ `
						<li class="result-item">
							<div class="result-heading">
								<h3 class="result-title">${title}</h3>
								<p class="result-category">${category}</p>
							</div>
							<p class="result-description">${description}</p>
						</li>`;
					})
					.join("");
			}
		</script>
	</body>
</html>
